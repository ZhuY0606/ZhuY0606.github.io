<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用Kotlin开发Android | 朱英</title>
    <meta name="description" content="专注于记录技术点滴">
    
    
    <link rel="preload" href="/assets/css/0.styles.156dfd87.css" as="style"><link rel="preload" href="/assets/js/app.2dc343f7.js" as="script"><link rel="preload" href="/assets/js/2.fd229d67.js" as="script"><link rel="preload" href="/assets/js/25.fa3e17d8.js" as="script"><link rel="prefetch" href="/assets/js/10.08e73dd4.js"><link rel="prefetch" href="/assets/js/11.8fbd68eb.js"><link rel="prefetch" href="/assets/js/12.a533e165.js"><link rel="prefetch" href="/assets/js/13.9b047eba.js"><link rel="prefetch" href="/assets/js/14.9ba5185f.js"><link rel="prefetch" href="/assets/js/15.12910bae.js"><link rel="prefetch" href="/assets/js/16.76759b0d.js"><link rel="prefetch" href="/assets/js/17.3414fe81.js"><link rel="prefetch" href="/assets/js/18.1c4213e8.js"><link rel="prefetch" href="/assets/js/19.e089ae4c.js"><link rel="prefetch" href="/assets/js/20.4e4d4319.js"><link rel="prefetch" href="/assets/js/21.40e37fd1.js"><link rel="prefetch" href="/assets/js/22.ef1f27f5.js"><link rel="prefetch" href="/assets/js/23.8681852a.js"><link rel="prefetch" href="/assets/js/24.2f78481b.js"><link rel="prefetch" href="/assets/js/26.762a3a6f.js"><link rel="prefetch" href="/assets/js/27.0460ebcc.js"><link rel="prefetch" href="/assets/js/28.f2abc173.js"><link rel="prefetch" href="/assets/js/29.eeeb93e4.js"><link rel="prefetch" href="/assets/js/3.a5393678.js"><link rel="prefetch" href="/assets/js/30.3e045f44.js"><link rel="prefetch" href="/assets/js/31.35efe00c.js"><link rel="prefetch" href="/assets/js/32.ff28f385.js"><link rel="prefetch" href="/assets/js/33.beacb89e.js"><link rel="prefetch" href="/assets/js/4.a3ac42f0.js"><link rel="prefetch" href="/assets/js/5.600899e5.js"><link rel="prefetch" href="/assets/js/6.8aecdf00.js"><link rel="prefetch" href="/assets/js/7.c28822d9.js"><link rel="prefetch" href="/assets/js/8.d87c7f65.js"><link rel="prefetch" href="/assets/js/9.21d08a48.js">
    <link rel="stylesheet" href="/assets/css/0.styles.156dfd87.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">朱英</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/android/" class="nav-link">Android</a></div><div class="nav-item"><a href="/flutter/" class="nav-link">Flutter</a></div><div class="nav-item"><a href="/kotlin/" class="nav-link router-link-active">Kotlin</a></div><div class="nav-item"><a href="/java/" class="nav-link">JAVA</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="https://github.com/ZhuY0606" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/android/" class="nav-link">Android</a></div><div class="nav-item"><a href="/flutter/" class="nav-link">Flutter</a></div><div class="nav-item"><a href="/kotlin/" class="nav-link router-link-active">Kotlin</a></div><div class="nav-item"><a href="/java/" class="nav-link">JAVA</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="https://github.com/ZhuY0606" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/kotlin/" class="sidebar-link">导航</a></li><li><a href="/kotlin/使用kotlin高效开发Android.html" class="active sidebar-link">使用Kotlin开发Android</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kotlin/使用kotlin高效开发Android.html#一、扩展函数" class="sidebar-link">一、扩展函数</a></li><li class="sidebar-sub-header"><a href="/kotlin/使用kotlin高效开发Android.html#二-with的用法" class="sidebar-link">二.    with的用法</a></li><li class="sidebar-sub-header"><a href="/kotlin/使用kotlin高效开发Android.html#三-kotlin的日志框架以及日志拦截器工具" class="sidebar-link">三 .Kotlin的日志框架以及日志拦截器工具</a></li><li class="sidebar-sub-header"><a href="/kotlin/使用kotlin高效开发Android.html#四、无需使用findviewbyid-或者-butterknife" class="sidebar-link">四、无需使用findViewById 或者 butterknife</a></li><li class="sidebar-sub-header"><a href="/kotlin/使用kotlin高效开发Android.html#五、点击事件的埋点处理" class="sidebar-link">五、点击事件的埋点处理</a></li><li class="sidebar-sub-header"><a href="/kotlin/使用kotlin高效开发Android.html#六、-、-、lateinit-以及-let" class="sidebar-link">六、?、!! 、lateinit 以及 let</a></li><li class="sidebar-sub-header"><a href="/kotlin/使用kotlin高效开发Android.html#七-dsl-domain-specific-language-的使用" class="sidebar-link">七. DSL (Domain-Specific Language)的使用</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="使用kotlin开发android"><a href="#使用kotlin开发android" aria-hidden="true" class="header-anchor">#</a> 使用Kotlin开发Android</h1> <h2 id="一、扩展函数"><a href="#一、扩展函数" aria-hidden="true" class="header-anchor">#</a> 一、扩展函数</h2> <p>Kotlin允许开发者在不改变已有类的情况下，为某个类添加新的函数。这个特性叫做扩展函数。</p> <p>举一个简单的例子。如果要关闭一个I/O流，使用Java可能是写一个工具方法。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">/**
     * 安全关闭io流
     * @param closeable
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeQuietly</span><span class="token punctuation">(</span><span class="token class-name">Closeable</span> closeable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>closeable <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                closeable<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>对Kotlin而言，可以对Closeable扩展一个函数closeQuietly()。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">fun</span> Closeable<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">closeQuietly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> Throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>之后，任何实现了Closeable接口的类，都可以使用它本身的closeQuietly()方法来关闭流。我们不再需要那个工具方法了。</p> <p>在项目中，我们使用扩展函数对Glide做了封装，大大简化了Glide的使用。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token comment">/**
 * 占位符矩形
 */</span><span class="token keyword">fun</span> ImageView<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>url<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">placeholder</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>shape_default_rec_bg<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>shape_default_rec_bg<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
 * 占位符圆角矩形
 */</span><span class="token keyword">fun</span> ImageView<span class="token punctuation">.</span><span class="token function">loadRound</span><span class="token punctuation">(</span>url<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">placeholder</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>shape_default_round_bg<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>shape_default_round_bg<span class="token punctuation">)</span><span class="token comment">//            .apply(RequestOptions.bitmapTransform(RoundedCornersTransformation(DisplayUtil.dp2px(context, 6f), 0)))</span>
            <span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token function">RoundedCornersTransformation</span><span class="token punctuation">(</span>DisplayUtil<span class="token punctuation">.</span><span class="token function">dp2px</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token number">6f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
 * 占位符圆形
 */</span><span class="token keyword">fun</span> ImageView<span class="token punctuation">.</span><span class="token function">loadCircle</span><span class="token punctuation">(</span>url<span class="token operator">:</span> Drawable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">placeholder</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>shape_default_circle_bg<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>shape_default_circle_bg<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">fun</span> ImageView<span class="token punctuation">.</span><span class="token function">loadCircle</span><span class="token punctuation">(</span>url<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">placeholder</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>shape_default_circle_bg<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>shape_default_circle_bg<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">fun</span> ImageView<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> GlideRequest<span class="token operator">&lt;</span>Drawable<span class="token operator">&gt;</span> <span class="token operator">=</span> GlideApp<span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">fun</span> ImageView<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token operator">:</span> Drawable<span class="token punctuation">)</span><span class="token operator">:</span> GlideRequest<span class="token operator">&lt;</span>Drawable<span class="token operator">&gt;</span> <span class="token operator">=</span> GlideApp<span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>Kolin的工具类库，它包括各种utils和各种extension
git地址：<a href="https://github.com/fengzhizi715/SAF-Kotlin-Utils" target="_blank" rel="noopener noreferrer">https://github.com/fengzhizi715/SAF-Kotlin-Utils<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="二-with的用法"><a href="#二-with的用法" aria-hidden="true" class="header-anchor">#</a> 二.    with的用法</h2> <p><img src="D:%5CmyPage%5Cdocs.vuepress%5Cpublic%5Ckotlin_with.png" alt="a"></p> <h2 id="三-kotlin的日志框架以及日志拦截器工具"><a href="#三-kotlin的日志框架以及日志拦截器工具" aria-hidden="true" class="header-anchor">#</a> 三 .Kotlin的日志框架以及日志拦截器工具</h2> <p>L的github地址：
<a href="https://github.com/fengzhizi715/SAF-Kotlin-log" target="_blank" rel="noopener noreferrer">https://github.com/fengzhizi715/SAF-Kotlin-log<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Retrofit日志拦截器的github地址：
<a href="https://github.com/fengzhizi715/saf-logginginterceptor" target="_blank" rel="noopener noreferrer">https://github.com/fengzhizi715/saf-logginginterceptor<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="四、无需使用findviewbyid-或者-butterknife"><a href="#四、无需使用findviewbyid-或者-butterknife" aria-hidden="true" class="header-anchor">#</a> 四、无需使用findViewById 或者 butterknife</h2> <p>使用Kotlin Android Extensions插件即可实现该功能，它是Kotlin 插件的组成之一，无需再单独安装插件。</p> <p>我们在各个modules的build.gradle中添加该插件，即可使用。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code>apply plugin<span class="token operator">:</span> <span class="token string">'kotlin-android-extensions'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>布局文件中的id，可以直接在代码中使用。
首先，按照import kotlinx.android.synthetic.main.布局文件名*的方式导入。</p> <p>例如MainActivity，它的布局文件是activity_main.xml
则按照如下的方式进行import</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">import</span> kotlinx<span class="token punctuation">.</span>android<span class="token punctuation">.</span>synthetic<span class="token punctuation">.</span>main<span class="token punctuation">.</span>activity_main<span class="token punctuation">.</span><span class="token operator">*</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>那么activity_main.xml中控件的id，可以直接在MainActivity中使用，无需使用findViewById 或者 butterknife。是不是特别方便？</p> <h2 id="五、点击事件的埋点处理"><a href="#五、点击事件的埋点处理" aria-hidden="true" class="header-anchor">#</a> 五、点击事件的埋点处理</h2> <p>Kolin的工具类库地址</p> <p><a href="https://github.com/fengzhizi715/SAF-Kotlin-Utils" target="_blank" rel="noopener noreferrer">https://github.com/fengzhizi715/SAF-Kotlin-Utils<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="六、-、-、lateinit-以及-let"><a href="#六、-、-、lateinit-以及-let" aria-hidden="true" class="header-anchor">#</a> 六、?、!! 、lateinit 以及 let</h2> <p>Kotlin 的类型系统旨在从我们的代码中消除NullPointerException。</p> <h3 id="_6-1"><a href="#_6-1" aria-hidden="true" class="header-anchor">#</a> 6.1 ?</h3> <p>Kotlin基于Java的空指针提出了一个空安全的概念，即每个属性默认不可为null。</p> <p>例如：</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">var</span> a<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string">&quot;test kotlin&quot;</span>
a <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">//编译错误</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>如果要允许为空，我们需要手动声明一个变量为可空字符串类型，写为String?</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">var</span> a<span class="token operator">:</span> String<span class="token operator">?</span> <span class="token operator">=</span> <span class="token string">&quot;test kotlin&quot;</span>
a <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">//编译成功</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_6-2"><a href="#_6-2" aria-hidden="true" class="header-anchor">#</a> 6.2 !!</h3> <p>!!是非空断言运算符。将任何值转换为非空类型，若该值为空则抛出异常。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">object</span> Test <span class="token punctuation">{</span>
 
    <span class="token keyword">var</span> s<span class="token operator">:</span>String<span class="token operator">?</span><span class="token operator">=</span><span class="token keyword">null</span>
 
    <span class="token annotation builtin">@JvmStatic</span>
    <span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 
        <span class="token function">println</span><span class="token punctuation">(</span>s<span class="token operator">!!</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>执行上述代码会抛出如下异常。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code>Exception <span class="token keyword">in</span> thread <span class="token string">&quot;main&quot;</span> kotlin<span class="token punctuation">.</span>KotlinNullPointerException
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在App快要发布时，我们会进行检查尽量避免使用“!!”,转而考虑使用lateinit或者let函数来代替它。</p> <h3 id="_6-3-lateinit"><a href="#_6-3-lateinit" aria-hidden="true" class="header-anchor">#</a> 6.3 lateinit</h3> <p>在某个类中，如果某些成员变量没办法在一开始就初始化，并且又不想使用可空类型(也就是带?的类型)。那么，可以使用lateinit来修饰它。</p> <p>被lateinit修饰的变量，并不是不初始化，它需要在生命周期流程中进行获取或者初始化。</p> <p>如果访问未初始化的 lateinit 变量会导致 UninitializedPropertyAccessException。</p> <h2 id="七-dsl-domain-specific-language-的使用"><a href="#七-dsl-domain-specific-language-的使用" aria-hidden="true" class="header-anchor">#</a> 七. DSL (Domain-Specific Language)的使用</h2> <p>Kotlin之美-DSL介绍链接：<a href="https://www.jianshu.com/p/f5f0d38e3e44" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/f5f0d38e3e44<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>这些只是目前我认识有用的东西，后续会继续补充。</p> <p>一些额外知识没贴出来，如果想看的下面有具体链接：</p> <p><a href="https://www.jianshu.com/p/5f77209abb9b" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/5f77209abb9b<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/kotlin/" class="prev router-link-active">
          导航
        </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2dc343f7.js" defer></script><script src="/assets/js/2.fd229d67.js" defer></script><script src="/assets/js/25.fa3e17d8.js" defer></script>
  </body>
</html>
