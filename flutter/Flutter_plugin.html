<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Flutter Plugin开发流程 | 朱英</title>
    <meta name="description" content="专注于记录技术点滴">
    
    
    <link rel="preload" href="/assets/css/0.styles.156dfd87.css" as="style"><link rel="preload" href="/assets/js/app.2dc343f7.js" as="script"><link rel="preload" href="/assets/js/2.fd229d67.js" as="script"><link rel="preload" href="/assets/js/18.1c4213e8.js" as="script"><link rel="prefetch" href="/assets/js/10.08e73dd4.js"><link rel="prefetch" href="/assets/js/11.8fbd68eb.js"><link rel="prefetch" href="/assets/js/12.a533e165.js"><link rel="prefetch" href="/assets/js/13.9b047eba.js"><link rel="prefetch" href="/assets/js/14.9ba5185f.js"><link rel="prefetch" href="/assets/js/15.12910bae.js"><link rel="prefetch" href="/assets/js/16.76759b0d.js"><link rel="prefetch" href="/assets/js/17.3414fe81.js"><link rel="prefetch" href="/assets/js/19.e089ae4c.js"><link rel="prefetch" href="/assets/js/20.4e4d4319.js"><link rel="prefetch" href="/assets/js/21.40e37fd1.js"><link rel="prefetch" href="/assets/js/22.ef1f27f5.js"><link rel="prefetch" href="/assets/js/23.8681852a.js"><link rel="prefetch" href="/assets/js/24.2f78481b.js"><link rel="prefetch" href="/assets/js/25.fa3e17d8.js"><link rel="prefetch" href="/assets/js/26.762a3a6f.js"><link rel="prefetch" href="/assets/js/27.0460ebcc.js"><link rel="prefetch" href="/assets/js/28.f2abc173.js"><link rel="prefetch" href="/assets/js/29.eeeb93e4.js"><link rel="prefetch" href="/assets/js/3.a5393678.js"><link rel="prefetch" href="/assets/js/30.3e045f44.js"><link rel="prefetch" href="/assets/js/31.35efe00c.js"><link rel="prefetch" href="/assets/js/32.ff28f385.js"><link rel="prefetch" href="/assets/js/33.beacb89e.js"><link rel="prefetch" href="/assets/js/4.a3ac42f0.js"><link rel="prefetch" href="/assets/js/5.600899e5.js"><link rel="prefetch" href="/assets/js/6.8aecdf00.js"><link rel="prefetch" href="/assets/js/7.c28822d9.js"><link rel="prefetch" href="/assets/js/8.d87c7f65.js"><link rel="prefetch" href="/assets/js/9.21d08a48.js">
    <link rel="stylesheet" href="/assets/css/0.styles.156dfd87.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">朱英</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/android/" class="nav-link">Android</a></div><div class="nav-item"><a href="/flutter/" class="nav-link router-link-active">Flutter</a></div><div class="nav-item"><a href="/kotlin/" class="nav-link">Kotlin</a></div><div class="nav-item"><a href="/java/" class="nav-link">JAVA</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="https://github.com/ZhuY0606" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/android/" class="nav-link">Android</a></div><div class="nav-item"><a href="/flutter/" class="nav-link router-link-active">Flutter</a></div><div class="nav-item"><a href="/kotlin/" class="nav-link">Kotlin</a></div><div class="nav-item"><a href="/java/" class="nav-link">JAVA</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="https://github.com/ZhuY0606" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/flutter/" class="sidebar-link">导航</a></li><li><a href="/flutter/Flutter2Android_1.html" class="sidebar-link">Android嵌套Flutter(上).md</a></li><li><a href="/flutter/Flutter2Android_2.html" class="sidebar-link">Android嵌套Flutter(上).md</a></li><li><a href="/flutter/Flutter_plugin.html" class="active sidebar-link">Flutter Plugin开发流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#package-介绍" class="sidebar-link">Package 介绍</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#developing-dart-packages" class="sidebar-link">Developing Dart packages</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#开发插件包" class="sidebar-link">开发插件包</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#添加文档" class="sidebar-link">添加文档</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#发布-packages" class="sidebar-link">发布 packages</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#处理包的相互依赖" class="sidebar-link">处理包的相互依赖</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#package-介绍-2" class="sidebar-link">Package 介绍</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#developing-dart-packages-2" class="sidebar-link">Developing Dart packages</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#开发插件包-2" class="sidebar-link">开发插件包</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#添加文档-2" class="sidebar-link">添加文档</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#发布-packages-2" class="sidebar-link">发布 packages</a></li><li class="sidebar-sub-header"><a href="/flutter/Flutter_plugin.html#处理包的相互依赖-2" class="sidebar-link">处理包的相互依赖</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="flutter-plugin开发流程"><a href="#flutter-plugin开发流程" aria-hidden="true" class="header-anchor">#</a> Flutter Plugin开发流程</h1> <h2 id="package-介绍"><a href="#package-介绍" aria-hidden="true" class="header-anchor">#</a> Package 介绍</h2> <p>使用package可以创建可轻松共享的模块化代码。一个最小的package包括</p> <ul><li><p>一个<code>pubspec.yaml</code>文件：声明了package的名称、版本、作者等的元数据文件。</p></li> <li><p>一个 <code>lib</code> 文件夹：包括包中公开的(public)代码，最少应有一个&lt;;package-name&gt;.dart`文件</p></li></ul> <h3 id="package-类型"><a href="#package-类型" aria-hidden="true" class="header-anchor">#</a> Package 类型</h3> <p>Packages可以包含多种内容：</p> <ul><li><p>Dart包：其中一些可能包含Flutter的特定功能，因此对Flutter框架具有依赖性，仅将其用于Flutter，例如<a href="https://pub.dartlang.org/packages/fluro" target="_blank" rel="noopener noreferrer"><code>fluro</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>包。</p></li> <li><p>插件包：一种专用的Dart包，其中包含用Dart代码编写的API，以及针对Android（使用Java或Kotlin）和/或针对iOS（使用ObjC或Swift）平台的特定实现。一个具体的例子是<a href="https://pub.dartlang.org/packages/battery" target="_blank" rel="noopener noreferrer"><code>battery</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>插件包。</p></li></ul> <h2 id="developing-dart-packages"><a href="#developing-dart-packages" aria-hidden="true" class="header-anchor">#</a> Developing Dart packages</h2> <h3 id="step-1-开发dart包"><a href="#step-1-开发dart包" aria-hidden="true" class="header-anchor">#</a> Step 1: 开发Dart包</h3> <p>要创建Dart包，请使用<code>--template=package</code> 来执行 <code>flutter create</code></p> <pre><code>&lt;span class=&quot;noselect&quot; style=&quot;&quot;&gt;$ &lt;/span&gt;flutter create --template=package hello`&lt;/pre&gt;

这将在`hello/`文件夹下创建一个具有以下专用内容的package工程：
</code></pre> <ul><li><p><code>lib/hello.dart</code>:</p> <pre><code>*   Package的Dart代码
</code></pre></li> <li><p><code>test/hello_test.dart</code>:</p> <pre><code>*   Package的[单元测试](https://flutter.io/testing/#unit-testing)代码.
</code></pre> <h3 id="step-2-实现package"><a href="#step-2-实现package" aria-hidden="true" class="header-anchor">#</a> Step 2: 实现package</h3> <p>对于纯Dart包，只需在主<code>lib/&amp;lt;package name&gt;.dart</code>文件内或<code>lib</code>目录中的文件中添加功能 。</p> <p>要测试软件包，请在<code>test</code>目录中添加<a href="https://flutter.io/testing/#unit-testing" target="_blank" rel="noopener noreferrer">unit tests<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>有关如何组织包内容的更多详细信息，请参阅<a href="https://www.dartlang.org/guides/libraries/create-library-packages" target="_blank" rel="noopener noreferrer">Dart library package<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>文档。</p> <h2 id="开发插件包"><a href="#开发插件包" aria-hidden="true" class="header-anchor">#</a> 开发插件包</h2> <p>如果你想开发一个调用特定平台API的包，你需要开发一个插件包，插件包是Dart包的专用版本。 插件包包含针对Android（Java或Kotlin代码）或iOS（Objective-C或Swift代码）编写的特定于平台的实现（可以同时包含Android和Ios原生的代码）。 API使用<a href="https://flutterchina.club/platform-channels/" target="_blank" rel="noopener noreferrer">platform channels<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>连接到特定平台（Android或IOS）。</p> <h3 id="step-1-创建-package"><a href="#step-1-创建-package" aria-hidden="true" class="header-anchor">#</a> Step 1: 创建 package</h3> <p>要创建插件包，请使用<code>--template=plugin</code>参数执行<code>flutter create</code></p> <p>使用<code>--org</code>选项指定您的组织，并使用反向域名表示法。该值用于生成的Android和iOS代码中的各种包和包标识符。
<pre style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;white-space:pre-wrap;padding:8.0px 12.0px;line-height:1.42857;color:rgb(52,73,94);background-color:rgb(245,245,245);border:1.0px solid rgb(204,204,204);margin-top:25.0px;margin-bottom:25.0px;"><code>&lt;span class=&quot;noselect&quot; style=&quot;&quot;&gt;$ &lt;/span&gt;flutter create --org com.example --template=plugin hello</code></pre></p> <p>这将在<code>hello/</code>文件夹下创建一个具有以下专用内容的插件工程：</p></li> <li><p><code>lib/hello.dart</code>:</p> <pre><code>*   插件包的Dart API.
</code></pre></li> <li><p><code>android/src/main/java/com/yourcompany/hello/HelloPlugin.java</code>:</p> <pre><code>*   插件包API的Android实现.
</code></pre></li> <li><p><code>ios/Classes/HelloPlugin.m</code>:</p> <pre><code>*   插件包API的ios实现.
</code></pre></li> <li><p><code>example/</code>:</p> <pre><code>*   一个依赖于该插件的Flutter应用程序，来说明如何使用它
</code></pre> <p>默认情况下，插件项目针对iOS代码使用Objective-C，Android代码使用Java。如果您更喜欢Swift或Kotlin，则可以使用<code>-i</code> 或 <code>-a</code> 为iOS或Android指定语言。例如：
<pre style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;white-space:pre-wrap;padding:8.0px 12.0px;line-height:1.42857;color:rgb(52,73,94);background-color:rgb(245,245,245);border:1.0px solid rgb(204,204,204);margin-top:25.0px;margin-bottom:25.0px;"><code>&lt;span class=&quot;noselect&quot; style=&quot;&quot;&gt;$ &lt;/span&gt;flutter create --template=plugin -i swift -a kotlin hello</code></pre></p> <h3 id="step-2-实现包-package"><a href="#step-2-实现包-package" aria-hidden="true" class="header-anchor">#</a> Step 2: 实现包 package</h3> <p>由于插件包中包含用多种编程语言编写的多个平台的代码，因此需要一些特定的步骤来确保顺畅的体验。</p> <h4 id="step-2a-定义包api（-dart）"><a href="#step-2a-定义包api（-dart）" aria-hidden="true" class="header-anchor">#</a> Step 2a: 定义包API（.dart）</h4> <p>插件包的API在Dart代码中定义。打开主文件夹<code>hello/</code>。找到<code>lib/hello.dart</code></p> <h4 id="step-2b-添加android平台代码（-java-kt）"><a href="#step-2b-添加android平台代码（-java-kt）" aria-hidden="true" class="header-anchor">#</a> Step 2b: 添加Android平台代码（.java / .kt）</h4> <p>我们建议您使用Android Studio编辑Android代码。</p> <p>在Android Studio中编辑Android平台代码之前，首先确保代码至少已经构建过一次（例如，从IntelliJ运行示例应用程序或在终端执行<code>cd hello/example</code>; <code>flutter build apk</code>）</p> <p>接下来</p></li></ul> <ol><li><p>启动Android Studio</p></li> <li><p>在’Welcome to Android Studio’对话框选择 ‘Import project’, 或者在菜单栏 ‘File &gt; New &gt; Import Project…‘,然后选择<code>hello/example/android/build.gradle</code>文件.</p></li> <li><p>在’Gradle Sync’ 对话框, 选择 ‘OK’.</p></li> <li><p>在’Android Gradle Plugin Update’ 对话框, 选择 ‘Don’t remind me again for this project’.</p> <p>您插件的Android平台代码位于 <code>hello/java/com.yourcompany.hello/HelloPlugin</code>.</p> <p>您可以通过按下 ▶ 按钮从Android Studio运行示例应用程序.</p> <h4 id="step-2c-添加ios平台代码-h-m-swift"><a href="#step-2c-添加ios平台代码-h-m-swift" aria-hidden="true" class="header-anchor">#</a> Step 2c: 添加iOS平台代码 (.h+.m/.swift)</h4> <p>我们建议您使用Xcode编辑iOS代码 。</p> <p>在编辑Xcode中的iOS平台代码之前，首先确保代码至少已经构建过一次（例如，从Xcode中运行示例应用程序或终端执行<code>cd hello/example</code>; <code>flutter build ios --no-codesign</code>）。</p> <p>接下来</p></li> <li><p>启动 Xcode</p></li> <li><p>选择 ‘File &gt; Open’, 然后选择 <code>hello/example/ios/Runner.xcworkspace</code> 文件.</p> <p>您插件的iOS平台代码位于<code>Pods/DevelopmentPods/hello/Classes/</code>中。</p> <p>您可以通过按下&amp;#9654按钮来运行示例应用程序</p> <h4 id="step-2d-连接api和平台代码"><a href="#step-2d-连接api和平台代码" aria-hidden="true" class="header-anchor">#</a> Step 2d: 连接API和平台代码</h4> <p>最后，您需要将用Dart代码编写的API与平台特定的实现连接起来。这是通过<a href="https://flutterchina.club/platform-channels/" target="_blank" rel="noopener noreferrer">platform channels<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>完成的。</p> <h2 id="添加文档"><a href="#添加文档" aria-hidden="true" class="header-anchor">#</a> 添加文档</h2> <p>建议将以下文档添加到所有软件包：</p></li> <li><p><code>README.md</code>:介绍包的文件</p></li> <li><p><code>CHANGELOG.md</code> 记录每个版本中的更改</p></li> <li><p><code>LICENSE</code> 包含软件包许可条款的文件</p></li> <li><p>所有公共API的API文档 (详情见下文)</p> <h3 id="api-documentation"><a href="#api-documentation" aria-hidden="true" class="header-anchor">#</a> API documentation</h3> <p>在发布软件包时，API文档会自动生成并发布到dartdocs.org，示例请参阅<a href="https://www.dartdocs.org/documentation/device_info/0.0.4/index.html" target="_blank" rel="noopener noreferrer">device_info docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>如果您希望在本地生成API文档，请使用以下命令：</p></li> <li><p>将目录更改为您的软件包的位置:
<code>cd ~/dev/mypackage</code></p></li> <li><p>告诉文档工具Flutter SDK的位置:
<code>export FLUTTER_ROOT=~/dev/flutter</code> (on macOS or Linux)
<code>set FLUTTER_ROOT=~/dev/flutter</code> (on Windows)</p></li> <li><p>运行 <code>dartdoc</code> 工具 (它是Flutter SDK的一部分):
<code>$FLUTTER_ROOT/bin/cache/dart-sdk/bin/dartdoc</code> (on macOS or Linux)
<code>%FLUTTER_ROOT%\bin\cache\dart-sdk\bin\dartdoc</code> (on Windows)</p> <p>有关如何编写API文档的提示，请参阅<a href="https://www.dartlang.org/guides/language/effective-dart/documentation" target="_blank" rel="noopener noreferrer">Effective Dart: Documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="发布-packages"><a href="#发布-packages" aria-hidden="true" class="header-anchor">#</a> 发布 packages</h2> <p>一旦你实现了一个包，你可以在<a href="https://pub.dartlang.org/" target="_blank" rel="noopener noreferrer">Pub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>上发布它 ，这样其他开发人员就可以轻松使用它</p> <p>在发布之前，检查<code>pubspec.yaml</code>、<code>README.md</code>以及<code>CHANGELOG.md</code>文件，以确保其内容的完整性和正确性。</p> <p>然后, 运行 dry-run 命令以查看是否都准备OK了:
<pre style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;white-space:pre-wrap;padding:8.0px 12.0px;line-height:1.42857;color:rgb(52,73,94);background-color:rgb(245,245,245);border:1.0px solid rgb(204,204,204);margin-top:25.0px;margin-bottom:25.0px;"><code>&lt;span class=&quot;noselect&quot; style=&quot;&quot;&gt;$ &lt;/span&gt;flutter packages pub publish --dry-run</code></pre></p> <p>最后, 运行发布命令:
<pre style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;white-space:pre-wrap;padding:8.0px 12.0px;line-height:1.42857;color:rgb(52,73,94);background-color:rgb(245,245,245);border:1.0px solid rgb(204,204,204);margin-top:25.0px;margin-bottom:25.0px;"><code>&lt;span class=&quot;noselect&quot; style=&quot;&quot;&gt;$ &lt;/span&gt;flutter packages pub publish</code></pre></p> <p>有关发布的详细信息，请参阅<a href="https://www.dartlang.org/tools/pub/publishing" target="_blank" rel="noopener noreferrer">Pub publishing docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="处理包的相互依赖"><a href="#处理包的相互依赖" aria-hidden="true" class="header-anchor">#</a> 处理包的相互依赖</h2> <p>如果您正在开发一个<code>hello</code>包，它依赖于另一个包，则需要将该依赖包添加到<code>pubspec.yaml</code>文件的<code>dependencies</code>部分。 下面的代码使<code>url_launcher</code>插件的Dart API ，这在<code>hello</code>包中是可用的：</p> <p>In <code>hello/pubspec.yaml</code>:
</p><div class="language-yaml highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-yaml" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;na&quot; style=&quot;&quot;&gt;dependencies&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;url_launcher&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot; style=&quot;&quot;&gt;^0.4.2&lt;/span&gt;</code></pre></div></div><p></p> <p>现在你可以在<code>hello</code>中<code>import 'package:url_launcher/url_launcher.dart'</code> 然后 <code>launch(someUrl)</code> 了。</p> <p>这与在Flutter应用程序或任何其他Dart项目中引用软件包没有什么不同</p> <p>但是，如果<code>hello</code>碰巧是一个插件包，其平台特定的代码需要访问<code>url_launcher</code>公开的特定于平台的API，那么您还需要为特定于平台的构建文件添加合适的依赖声明，如下所示。</p> <h3 id="android"><a href="#android" aria-hidden="true" class="header-anchor">#</a> Android</h3> <p>在 <code>hello/android/build.gradle</code>:
</p><div class="language-groovy highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-groovy" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;n&quot; style=&quot;&quot;&gt;android&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot; style=&quot;&quot;&gt;// lines skipped&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;&quot;&gt;dependencies&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;&quot;&gt;provided&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;&quot;&gt;rootProject&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;&quot;&gt;findProject&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; style=&quot;&quot;&gt;&amp;quot;:url_launcher&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;}&lt;/span&gt;</code></pre></div></div><p></p> <p>您现在可以在<code>hello/android/src</code>源码中<code>import io.flutter.plugins.urllauncher.UrlLauncherPlugin</code>访问<code>UrlLauncherPlugin</code>类</p> <h3 id="ios"><a href="#ios" aria-hidden="true" class="header-anchor">#</a> iOS</h3> <p>在<code>hello/ios/hello.podspec</code>:
</p><div class="language-ruby highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-ruby" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;no&quot; style=&quot;&quot;&gt;Pod&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot; style=&quot;&quot;&gt;Spec&lt;/span&gt;&lt;span class=&quot;p&quot; style=&quot;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;c1&quot; style=&quot;&quot;&gt;# lines skipped&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot; style=&quot;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;&quot;&gt;dependency&lt;/span&gt; &lt;span class=&quot;s1&quot; style=&quot;&quot;&gt;'url_launcher'&lt;/span&gt;</code></pre></div></div><p></p> <p>您现在可以在<code>hello/ios/Classes</code>源码中 <code>#import &amp;quot;UrlLauncherPlugin.h&amp;quot;</code> 然后访问 <code>UrlLauncherPlugin</code> 类</p> <h3 id="解决冲突"><a href="#解决冲突" aria-hidden="true" class="header-anchor">#</a> 解决冲突</h3> <p>假设你想在你的<code>hello</code>包中使用<code>some_package</code>和<code>other_package</code>，并且这两个包都依赖<code>url_launcher</code>，但是依赖的是<code>url_launcher</code>的不同的版本。 那我们就有潜在的冲突。避免这种情况的最好方法是在指定依赖关系时，程序包作者使用<a href="https://www.dartlang.org/tools/pub/dependencies#version-constraints" target="_blank" rel="noopener noreferrer">版本范围<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>而不是特定版本。
</p><div class="language-yaml highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-yaml" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;na&quot; style=&quot;&quot;&gt;dependencies&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;url_launcher&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot; style=&quot;&quot;&gt;^0.4.2&lt;/span&gt; &lt;span class=&quot;c1&quot; style=&quot;&quot;&gt;# Good, any 0.4.x with x &gt;= 2 will do.&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;image_picker&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot; style=&quot;&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;&quot;&gt;0.1.1'&lt;/span&gt; &lt;span class=&quot;c1&quot; style=&quot;&quot;&gt;# Not so good, only 0.1.1 will do.&lt;/span&gt;</code></pre></div></div><p></p> <p>如果<code>some_package</code>声明了上面的依赖关系,<code>other_package</code>声明了<code>url_launcher</code>版本像’0.4.5’或’^0.4.0’，pub将能够自动解决问题。 类似的注释适用于插件包对Gradle模块和<a href="https://guides.cocoapods.org/syntax/podspec.html#dependency" target="_blank" rel="noopener noreferrer">Cocoa pods<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的平台特定的依赖关系。</p> <p>即使<code>some_package</code>和<code>other_package</code>声明了不兼容的<code>url_launcher</code>版本，它仍然可能会和<code>url_launcher</code>以兼容的方式正常工作。 你可以通过向<code>hello</code>包的<code>pubspec.yaml</code>文件中添加依赖性覆盖声明来处理冲突，从而强制使用特定版本：</p> <p>强制使用 <code>0.4.3</code>版本的<code>url_launcher</code>，在 <code>hello/pubspec.yaml</code>中:
</p><div class="language-yaml highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-yaml" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;na&quot; style=&quot;&quot;&gt;dependencies&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;some_package&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;other_package&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;dependency_overrides&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;url_launcher&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot; style=&quot;&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;&quot;&gt;0.4.3'&lt;/span&gt;</code></pre></div></div><p></p> <p>如果冲突的依赖不是一个包，而是一个特定于Android的库，比如<code>guava</code>，那么必须将依赖重写声明添加到Gradle构建逻辑中。</p> <p>强制使用<code>23.0</code>版本的<code>guava</code>库，在<code>hello/android/build.gradle</code>中：
</p><div class="language-groovy highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-groovy" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;n&quot; style=&quot;&quot;&gt;configurations&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;&quot;&gt;all&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;&quot;&gt;resolutionStrategy&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;&quot;&gt;force&lt;/span&gt; &lt;span class=&quot;s1&quot; style=&quot;&quot;&gt;'com.google.guava:guava:23.0-android'&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;}&lt;/span&gt;</code></pre></div></div><p></p> <p>Cocoapods目前不提供依赖覆盖功能。</p> <h2 id="package-介绍-2"><a href="#package-介绍-2" aria-hidden="true" class="header-anchor">#</a> Package 介绍</h2> <p>使用package可以创建可轻松共享的模块化代码。一个最小的package包括</p></li></ol> <ul><li><p>一个<code>pubspec.yaml</code>文件：声明了package的名称、版本、作者等的元数据文件。</p></li> <li><p>一个 <code>lib</code> 文件夹：包括包中公开的(public)代码，最少应有一个&lt;;package-name&gt;.dart`文件</p> <h3 id="package-类型-2"><a href="#package-类型-2" aria-hidden="true" class="header-anchor">#</a> Package 类型</h3> <p>Packages可以包含多种内容：</p></li> <li><p>Dart包：其中一些可能包含Flutter的特定功能，因此对Flutter框架具有依赖性，仅将其用于Flutter，例如<a href="https://pub.dartlang.org/packages/fluro" target="_blank" rel="noopener noreferrer"><code>fluro</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>包。</p></li> <li><p>插件包：一种专用的Dart包，其中包含用Dart代码编写的API，以及针对Android（使用Java或Kotlin）和/或针对iOS（使用ObjC或Swift）平台的特定实现。一个具体的例子是<a href="https://pub.dartlang.org/packages/battery" target="_blank" rel="noopener noreferrer"><code>battery</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>插件包。</p> <h2 id="developing-dart-packages-2"><a href="#developing-dart-packages-2" aria-hidden="true" class="header-anchor">#</a> Developing Dart packages</h2> <h3 id="step-1-开发dart包-2"><a href="#step-1-开发dart包-2" aria-hidden="true" class="header-anchor">#</a> Step 1: 开发Dart包</h3> <p>要创建Dart包，请使用<code>--template=package</code> 来执行 <code>flutter create</code> <pre style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;white-space:pre-wrap;padding:8.0px 12.0px;line-height:1.42857;color:rgb(52,73,94);background-color:rgb(245,245,245);border:1.0px solid rgb(204,204,204);margin-top:25.0px;margin-bottom:25.0px;"><code>&lt;span class=&quot;noselect&quot; style=&quot;&quot;&gt;$ &lt;/span&gt;flutter create --template=package hello</code></pre></p> <p>这将在<code>hello/</code>文件夹下创建一个具有以下专用内容的package工程：</p></li> <li><p><code>lib/hello.dart</code>:</p> <pre><code>*   Package的Dart代码
</code></pre></li> <li><p><code>test/hello_test.dart</code>:</p> <pre><code>*   Package的[单元测试](https://flutter.io/testing/#unit-testing)代码.
</code></pre> <h3 id="step-2-实现package-2"><a href="#step-2-实现package-2" aria-hidden="true" class="header-anchor">#</a> Step 2: 实现package</h3> <p>对于纯Dart包，只需在主<code>lib/&amp;lt;package name&gt;.dart</code>文件内或<code>lib</code>目录中的文件中添加功能 。</p> <p>要测试软件包，请在<code>test</code>目录中添加<a href="https://flutter.io/testing/#unit-testing" target="_blank" rel="noopener noreferrer">unit tests<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>有关如何组织包内容的更多详细信息，请参阅<a href="https://www.dartlang.org/guides/libraries/create-library-packages" target="_blank" rel="noopener noreferrer">Dart library package<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>文档。</p> <h2 id="开发插件包-2"><a href="#开发插件包-2" aria-hidden="true" class="header-anchor">#</a> 开发插件包</h2> <p>如果你想开发一个调用特定平台API的包，你需要开发一个插件包，插件包是Dart包的专用版本。 插件包包含针对Android（Java或Kotlin代码）或iOS（Objective-C或Swift代码）编写的特定于平台的实现（可以同时包含Android和Ios原生的代码）。 API使用<a href="https://flutterchina.club/platform-channels/" target="_blank" rel="noopener noreferrer">platform channels<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>连接到特定平台（Android或IOS）。</p> <h3 id="step-1-创建-package-2"><a href="#step-1-创建-package-2" aria-hidden="true" class="header-anchor">#</a> Step 1: 创建 package</h3> <p>要创建插件包，请使用<code>--template=plugin</code>参数执行<code>flutter create</code></p> <p>使用<code>--org</code>选项指定您的组织，并使用反向域名表示法。该值用于生成的Android和iOS代码中的各种包和包标识符。
<pre style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;white-space:pre-wrap;padding:8.0px 12.0px;line-height:1.42857;color:rgb(52,73,94);background-color:rgb(245,245,245);border:1.0px solid rgb(204,204,204);margin-top:25.0px;margin-bottom:25.0px;"><code>&lt;span class=&quot;noselect&quot; style=&quot;&quot;&gt;$ &lt;/span&gt;flutter create --org com.example --template=plugin hello</code></pre></p> <p>这将在<code>hello/</code>文件夹下创建一个具有以下专用内容的插件工程：</p></li> <li><p><code>lib/hello.dart</code>:</p> <pre><code>*   插件包的Dart API.
</code></pre></li> <li><p><code>android/src/main/java/com/yourcompany/hello/HelloPlugin.java</code>:</p> <pre><code>*   插件包API的Android实现.
</code></pre></li> <li><p><code>ios/Classes/HelloPlugin.m</code>:</p> <pre><code>*   插件包API的ios实现.
</code></pre></li> <li><p><code>example/</code>:</p> <pre><code>*   一个依赖于该插件的Flutter应用程序，来说明如何使用它
</code></pre> <p>默认情况下，插件项目针对iOS代码使用Objective-C，Android代码使用Java。如果您更喜欢Swift或Kotlin，则可以使用<code>-i</code> 或 <code>-a</code> 为iOS或Android指定语言。例如：
<pre style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;white-space:pre-wrap;padding:8.0px 12.0px;line-height:1.42857;color:rgb(52,73,94);background-color:rgb(245,245,245);border:1.0px solid rgb(204,204,204);margin-top:25.0px;margin-bottom:25.0px;"><code>&lt;span class=&quot;noselect&quot; style=&quot;&quot;&gt;$ &lt;/span&gt;flutter create --template=plugin -i swift -a kotlin hello</code></pre></p> <h3 id="step-2-实现包-package-2"><a href="#step-2-实现包-package-2" aria-hidden="true" class="header-anchor">#</a> Step 2: 实现包 package</h3> <p>由于插件包中包含用多种编程语言编写的多个平台的代码，因此需要一些特定的步骤来确保顺畅的体验。</p> <h4 id="step-2a-定义包api（-dart）-2"><a href="#step-2a-定义包api（-dart）-2" aria-hidden="true" class="header-anchor">#</a> Step 2a: 定义包API（.dart）</h4> <p>插件包的API在Dart代码中定义。打开主文件夹<code>hello/</code>。找到<code>lib/hello.dart</code></p> <h4 id="step-2b-添加android平台代码（-java-kt）-2"><a href="#step-2b-添加android平台代码（-java-kt）-2" aria-hidden="true" class="header-anchor">#</a> Step 2b: 添加Android平台代码（.java / .kt）</h4> <p>我们建议您使用Android Studio编辑Android代码。</p> <p>在Android Studio中编辑Android平台代码之前，首先确保代码至少已经构建过一次（例如，从IntelliJ运行示例应用程序或在终端执行<code>cd hello/example</code>; <code>flutter build apk</code>）</p> <p>接下来</p></li></ul> <ol><li><p>启动Android Studio</p></li> <li><p>在’Welcome to Android Studio’对话框选择 ‘Import project’, 或者在菜单栏 ‘File &gt; New &gt; Import Project…‘,然后选择<code>hello/example/android/build.gradle</code>文件.</p></li> <li><p>在’Gradle Sync’ 对话框, 选择 ‘OK’.</p></li> <li><p>在’Android Gradle Plugin Update’ 对话框, 选择 ‘Don’t remind me again for this project’.</p> <p>您插件的Android平台代码位于 <code>hello/java/com.yourcompany.hello/HelloPlugin</code>.</p> <p>您可以通过按下 ▶ 按钮从Android Studio运行示例应用程序.</p> <h4 id="step-2c-添加ios平台代码-h-m-swift-2"><a href="#step-2c-添加ios平台代码-h-m-swift-2" aria-hidden="true" class="header-anchor">#</a> Step 2c: 添加iOS平台代码 (.h+.m/.swift)</h4> <p>我们建议您使用Xcode编辑iOS代码 。</p> <p>在编辑Xcode中的iOS平台代码之前，首先确保代码至少已经构建过一次（例如，从Xcode中运行示例应用程序或终端执行<code>cd hello/example</code>; <code>flutter build ios --no-codesign</code>）。</p> <p>接下来</p></li> <li><p>启动 Xcode</p></li> <li><p>选择 ‘File &gt; Open’, 然后选择 <code>hello/example/ios/Runner.xcworkspace</code> 文件.</p> <p>您插件的iOS平台代码位于<code>Pods/DevelopmentPods/hello/Classes/</code>中。</p> <p>您可以通过按下&amp;#9654按钮来运行示例应用程序</p> <h4 id="step-2d-连接api和平台代码-2"><a href="#step-2d-连接api和平台代码-2" aria-hidden="true" class="header-anchor">#</a> Step 2d: 连接API和平台代码</h4> <p>最后，您需要将用Dart代码编写的API与平台特定的实现连接起来。这是通过<a href="https://flutterchina.club/platform-channels/" target="_blank" rel="noopener noreferrer">platform channels<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>完成的。</p> <h2 id="添加文档-2"><a href="#添加文档-2" aria-hidden="true" class="header-anchor">#</a> 添加文档</h2> <p>建议将以下文档添加到所有软件包：</p></li> <li><p><code>README.md</code>:介绍包的文件</p></li> <li><p><code>CHANGELOG.md</code> 记录每个版本中的更改</p></li> <li><p><code>LICENSE</code> 包含软件包许可条款的文件</p></li> <li><p>所有公共API的API文档 (详情见下文)</p> <h3 id="api-documentation-2"><a href="#api-documentation-2" aria-hidden="true" class="header-anchor">#</a> API documentation</h3> <p>在发布软件包时，API文档会自动生成并发布到dartdocs.org，示例请参阅<a href="https://www.dartdocs.org/documentation/device_info/0.0.4/index.html" target="_blank" rel="noopener noreferrer">device_info docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>如果您希望在本地生成API文档，请使用以下命令：</p></li> <li><p>将目录更改为您的软件包的位置:
<code>cd ~/dev/mypackage</code></p></li> <li><p>告诉文档工具Flutter SDK的位置:
<code>export FLUTTER_ROOT=~/dev/flutter</code> (on macOS or Linux)
<code>set FLUTTER_ROOT=~/dev/flutter</code> (on Windows)</p></li> <li><p>运行 <code>dartdoc</code> 工具 (它是Flutter SDK的一部分):
<code>$FLUTTER_ROOT/bin/cache/dart-sdk/bin/dartdoc</code> (on macOS or Linux)
<code>%FLUTTER_ROOT%\bin\cache\dart-sdk\bin\dartdoc</code> (on Windows)</p> <p>有关如何编写API文档的提示，请参阅<a href="https://www.dartlang.org/guides/language/effective-dart/documentation" target="_blank" rel="noopener noreferrer">Effective Dart: Documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="发布-packages-2"><a href="#发布-packages-2" aria-hidden="true" class="header-anchor">#</a> 发布 packages</h2> <p>一旦你实现了一个包，你可以在<a href="https://pub.dartlang.org/" target="_blank" rel="noopener noreferrer">Pub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>上发布它 ，这样其他开发人员就可以轻松使用它</p> <p>在发布之前，检查<code>pubspec.yaml</code>、<code>README.md</code>以及<code>CHANGELOG.md</code>文件，以确保其内容的完整性和正确性。</p> <p>然后, 运行 dry-run 命令以查看是否都准备OK了:
<pre style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;white-space:pre-wrap;padding:8.0px 12.0px;line-height:1.42857;color:rgb(52,73,94);background-color:rgb(245,245,245);border:1.0px solid rgb(204,204,204);margin-top:25.0px;margin-bottom:25.0px;"><code>&lt;span class=&quot;noselect&quot; style=&quot;&quot;&gt;$ &lt;/span&gt;flutter packages pub publish --dry-run</code></pre></p> <p>最后, 运行发布命令:
<pre style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;white-space:pre-wrap;padding:8.0px 12.0px;line-height:1.42857;color:rgb(52,73,94);background-color:rgb(245,245,245);border:1.0px solid rgb(204,204,204);margin-top:25.0px;margin-bottom:25.0px;"><code>&lt;span class=&quot;noselect&quot; style=&quot;&quot;&gt;$ &lt;/span&gt;flutter packages pub publish</code></pre></p> <p>有关发布的详细信息，请参阅<a href="https://www.dartlang.org/tools/pub/publishing" target="_blank" rel="noopener noreferrer">Pub publishing docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="处理包的相互依赖-2"><a href="#处理包的相互依赖-2" aria-hidden="true" class="header-anchor">#</a> 处理包的相互依赖</h2> <p>如果您正在开发一个<code>hello</code>包，它依赖于另一个包，则需要将该依赖包添加到<code>pubspec.yaml</code>文件的<code>dependencies</code>部分。 下面的代码使<code>url_launcher</code>插件的Dart API ，这在<code>hello</code>包中是可用的：</p> <p>In <code>hello/pubspec.yaml</code>:
</p><div class="language-yaml highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-yaml" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;na&quot; style=&quot;&quot;&gt;dependencies&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;url_launcher&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot; style=&quot;&quot;&gt;^0.4.2&lt;/span&gt;</code></pre></div></div><p></p> <p>现在你可以在<code>hello</code>中<code>import 'package:url_launcher/url_launcher.dart'</code> 然后 <code>launch(someUrl)</code> 了。</p> <p>这与在Flutter应用程序或任何其他Dart项目中引用软件包没有什么不同</p> <p>但是，如果<code>hello</code>碰巧是一个插件包，其平台特定的代码需要访问<code>url_launcher</code>公开的特定于平台的API，那么您还需要为特定于平台的构建文件添加合适的依赖声明，如下所示。</p> <h3 id="android-2"><a href="#android-2" aria-hidden="true" class="header-anchor">#</a> Android</h3> <p>在 <code>hello/android/build.gradle</code>:
</p><div class="language-groovy highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-groovy" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;n&quot; style=&quot;&quot;&gt;android&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot; style=&quot;&quot;&gt;// lines skipped&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;&quot;&gt;dependencies&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;&quot;&gt;provided&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;&quot;&gt;rootProject&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;&quot;&gt;findProject&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; style=&quot;&quot;&gt;&amp;quot;:url_launcher&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;}&lt;/span&gt;</code></pre></div></div><p></p> <p>您现在可以在<code>hello/android/src</code>源码中<code>import io.flutter.plugins.urllauncher.UrlLauncherPlugin</code>访问<code>UrlLauncherPlugin</code>类</p> <h3 id="ios-2"><a href="#ios-2" aria-hidden="true" class="header-anchor">#</a> iOS</h3> <p>在<code>hello/ios/hello.podspec</code>:
</p><div class="language-ruby highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-ruby" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;no&quot; style=&quot;&quot;&gt;Pod&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot; style=&quot;&quot;&gt;Spec&lt;/span&gt;&lt;span class=&quot;p&quot; style=&quot;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;c1&quot; style=&quot;&quot;&gt;# lines skipped&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot; style=&quot;&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot; style=&quot;&quot;&gt;dependency&lt;/span&gt; &lt;span class=&quot;s1&quot; style=&quot;&quot;&gt;'url_launcher'&lt;/span&gt;</code></pre></div></div><p></p> <p>您现在可以在<code>hello/ios/Classes</code>源码中 <code>#import &amp;quot;UrlLauncherPlugin.h&amp;quot;</code> 然后访问 <code>UrlLauncherPlugin</code> 类</p> <h3 id="解决冲突-2"><a href="#解决冲突-2" aria-hidden="true" class="header-anchor">#</a> 解决冲突</h3> <p>假设你想在你的<code>hello</code>包中使用<code>some_package</code>和<code>other_package</code>，并且这两个包都依赖<code>url_launcher</code>，但是依赖的是<code>url_launcher</code>的不同的版本。 那我们就有潜在的冲突。避免这种情况的最好方法是在指定依赖关系时，程序包作者使用<a href="https://www.dartlang.org/tools/pub/dependencies#version-constraints" target="_blank" rel="noopener noreferrer">版本范围<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>而不是特定版本。
</p><div class="language-yaml highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-yaml" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;na&quot; style=&quot;&quot;&gt;dependencies&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;url_launcher&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot; style=&quot;&quot;&gt;^0.4.2&lt;/span&gt; &lt;span class=&quot;c1&quot; style=&quot;&quot;&gt;# Good, any 0.4.x with x &gt;= 2 will do.&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;image_picker&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot; style=&quot;&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;&quot;&gt;0.1.1'&lt;/span&gt; &lt;span class=&quot;c1&quot; style=&quot;&quot;&gt;# Not so good, only 0.1.1 will do.&lt;/span&gt;</code></pre></div></div><p></p> <p>如果<code>some_package</code>声明了上面的依赖关系,<code>other_package</code>声明了<code>url_launcher</code>版本像’0.4.5’或’^0.4.0’，pub将能够自动解决问题。 类似的注释适用于插件包对Gradle模块和<a href="https://guides.cocoapods.org/syntax/podspec.html#dependency" target="_blank" rel="noopener noreferrer">Cocoa pods<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的平台特定的依赖关系。</p> <p>即使<code>some_package</code>和<code>other_package</code>声明了不兼容的<code>url_launcher</code>版本，它仍然可能会和<code>url_launcher</code>以兼容的方式正常工作。 你可以通过向<code>hello</code>包的<code>pubspec.yaml</code>文件中添加依赖性覆盖声明来处理冲突，从而强制使用特定版本：</p> <p>强制使用 <code>0.4.3</code>版本的<code>url_launcher</code>，在 <code>hello/pubspec.yaml</code>中:
</p><div class="language-yaml highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-yaml" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);"><code>&lt;span class=&quot;na&quot; style=&quot;&quot;&gt;dependencies&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;some_package&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;other_package&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;dependency_overrides&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;&quot;&gt;url_launcher&lt;/span&gt;&lt;span class=&quot;pi&quot; style=&quot;&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot; style=&quot;&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;&quot;&gt;0.4.3'&lt;/span&gt;</code></pre></div></div><p></p> <p>如果冲突的依赖不是一个包，而是一个特定于Android的库，比如<code>guava</code>，那么必须将依赖重写声明添加到Gradle构建逻辑中。</p> <p>强制使用<code>23.0</code>版本的<code>guava</code>库，在<code>hello/android/build.gradle</code>中：
</p><div class="language-groovy highlighter-rouge" style="top:-1.0px;margin:0.0px 1.0px;font-size:0.85em;padding:3.0px 4.0px;color:rgb(85,85,85);background-color:rgb(253,253,253);"><div class="highlight"><pre class="highlight language-groovy" style="font-family:SFMono-Regular , Menlo , &quot;Roboto Mono&quot; , Monaco , courier , monospace;font-size:13.0px;padding:1.0em;margin-top:0.5em;margin-bottom:0.5em;line-height:1.5;color:black;border:1.0px solid rgb(204,204,204);overflow:auto;text-shadow:inherit;word-spacing:normal;background-color:rgb(247,247,247);">`<span class="n">configurations</span><span class="o">.</span><span class="na">all</span> <span class="o">{</span>
<span class="n">resolutionStrategy</span> <span class="o">{</span>
<span class="n">force</span> <span class="s1">'com.google.guava:guava:23.0-android'</span>
<span class="o">}</span>
<span class="o">}</span><p></p>
</pre></div></div></li></ol> <p>Cocoapods目前不提供依赖覆盖功能。</p> <pre><code>    &lt;/div&gt;</code></pre></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/flutter/Flutter2Android_2.html" class="prev">
          Android嵌套Flutter(上).md
        </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2dc343f7.js" defer></script><script src="/assets/js/2.fd229d67.js" defer></script><script src="/assets/js/18.1c4213e8.js" defer></script>
  </body>
</html>
